!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.InsaneAnalytics=e():t.InsaneAnalytics=e()}(this,(()=>{return t={877:t=>{class e{constructor(t={}){this.debug("Constructor called with config:",t),this.config={endpoint:t.endpoint?.replace(/\/$/,"")||"https://api.insaneanalytics.com",domainId:t.domainId,batchSize:t.batchSize||10,batchInterval:t.batchInterval||5e3,debug:t.debug||!1},this.queue=[],this.visitorId=this.getVisitorId(),this.sessionId=this.generateId(),this.startTime=Date.now(),this.lastActiveTime=Date.now(),this.activeTime=0,this.isActive=!1,this.initialized=!1,this.interactions=0,this.maxScrollDepth=0,this.handleActivity=this.handleActivity.bind(this),this.handleScroll=this.handleScroll.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.handleExit=this.handleExit.bind(this),t.domainId&&this.init()}init(){if(this.debug("Initializing..."),!this.initialized)try{this.setupEventListeners(),this.startBatchProcessing(),this.trackPerformance(),this.trackPageview(),this.initialized=!0,this.debug("Initialization complete")}catch(t){console.error("Initialization error:",t)}}setupEventListeners(){["mousemove","keypress","click"].forEach((t=>{document.addEventListener(t,this.handleActivity)})),document.addEventListener("scroll",this.handleScroll),document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("beforeunload",this.handleExit)}handleActivity(){const t=Date.now();this.isActive||(this.isActive=!0,this.track("activity_start")),t-this.lastActiveTime>1e3&&(this.activeTime+=t-this.lastActiveTime),this.lastActiveTime=t,this.interactions++}handleScroll(){const t=window.innerHeight,e=document.documentElement.scrollHeight,i=window.scrollY,n=Math.round(i/(e-t)*100);n>this.maxScrollDepth&&(this.maxScrollDepth=n,this.track("scroll_depth",{depth:this.maxScrollDepth}))}handleVisibilityChange(){const t=document.hidden?"page_hide":"page_show",e=document.hidden?{activeTime:this.activeTime,totalTime:Date.now()-this.startTime}:{};this.track(t,e)}handleExit(){if(this.track("page_exit",{activeTime:this.activeTime,totalTime:Date.now()-this.startTime,maxScrollDepth:this.maxScrollDepth,interactions:this.interactions}),navigator.sendBeacon){const t=this.queue.splice(0,this.queue.length);navigator.sendBeacon(`${this.config.endpoint}/collect`,JSON.stringify(t))}}trackPerformance(){if(!window.performance)return;const t=performance.timing,e=t.loadEventEnd-t.navigationStart,i=t.domContentLoadedEventEnd-t.navigationStart;this.track("performance",{loadTime:e,domLoadTime:i,firstPaint:performance.getEntriesByType("paint")[0]?.startTime}),this.measureConnectionSpeed()}async measureConnectionSpeed(){try{const t=performance.now(),e=await fetch(`${this.config.endpoint}/beacon`,{cache:"no-cache"}),i=performance.now()-t,n=8*parseInt(e.headers.get("content-length")||0)/(i/1e3)/1e6;this.track("connection_speed",{speed:n})}catch(t){this.debug("Error measuring connection speed:",t)}}trackPageview(){this.track("pageview",{url:window.location.href,referrer:document.referrer,title:document.title,utmParams:this.getUtmParams()})}track(t,e={}){const i={eventType:t,timestamp:(new Date).toISOString(),visitorId:this.visitorId,sessionId:this.sessionId,domainId:this.config.domainId,url:window.location.href,userAgent:navigator.userAgent,...e};this.queue.push(i),this.debug(`Tracked ${t}:`,i),this.queue.length>=this.config.batchSize&&this.sendBatch()}startBatchProcessing(){setInterval((()=>this.sendBatch()),this.config.batchInterval)}async sendBatch(){if(0===this.queue.length)return;const t=this.queue.splice(0,this.config.batchSize);try{const e=await fetch(`${this.config.endpoint}/collect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`)}catch(e){this.debug("Error sending batch:",e),this.queue.unshift(...t)}}generateId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}getVisitorId(){let t=localStorage.getItem("_ia_vid");return t||(t=this.generateId(),localStorage.setItem("_ia_vid",t)),t}getUtmParams(){const t=new URLSearchParams(window.location.search);return{source:t.get("utm_source"),medium:t.get("utm_medium"),campaign:t.get("utm_campaign"),term:t.get("utm_term"),content:t.get("utm_content")}}debug(...t){this.config.debug&&console.log("[InsaneAnalytics]",...t)}}if("undefined"!=typeof window){const i=new e;(window.ia?.q||[]).forEach((t=>{"function"==typeof i[t[0]]&&i[t[0]].apply(i,t.slice(1))})),window.ia=function(){"function"==typeof i[arguments[0]]&&i[arguments[0]].apply(i,Array.prototype.slice.call(arguments,1))},t.exports=e}}},e={},function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,i),a.exports}(877);var t,e}));