!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.InsaneAnalytics=e():t.InsaneAnalytics=e()}(this,(()=>{return t={877:t=>{class e{constructor(t={}){console.log("InsaneAnalytics: Constructor called with config:",t),this.config={endpoint:t.endpoint||"https://api.insaneanalytics.com",domainId:t.domainId,batchSize:t.batchSize||10,batchInterval:t.batchInterval||5e3,debug:t.debug||!1},this.queue=[],this.visitorId=this.getVisitorId(),this.sessionId=this.generateId(),this.startTime=Date.now(),this.lastActiveTime=Date.now(),this.activeTime=0,this.isActive=!1,this.initialized=!1,this.pageLoadTime=null,this.scrollDepth=0,this.maxScrollDepth=0,this.interactions=0,t.domainId&&this.init()}init(){if(console.log("InsaneAnalytics: Initializing..."),!this.initialized){this.initialized=!0;try{this.trackPageview(),this.setupEventListeners(),this.startBatchProcessing(),this.trackPerformance(),console.log("InsaneAnalytics: Initialization complete")}catch(t){console.error("InsaneAnalytics: Initialization error:",t)}}}setupEventListeners(){document.addEventListener("mousemove",this.handleActivity.bind(this)),document.addEventListener("keypress",this.handleActivity.bind(this)),document.addEventListener("click",this.handleActivity.bind(this)),document.addEventListener("scroll",this.handleScroll.bind(this)),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),window.addEventListener("beforeunload",this.handleExit.bind(this))}handleActivity(){const t=Date.now();this.isActive||(this.isActive=!0,this.track("activity_start")),t-this.lastActiveTime>1e3&&(this.activeTime+=t-this.lastActiveTime),this.lastActiveTime=t,this.interactions++}handleScroll(){const t=window.innerHeight,e=Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.body.scrollHeight,document.body.offsetHeight),i=window.pageYOffset||document.documentElement.scrollTop,n=Math.round(i/(e-t)*100);n>this.maxScrollDepth&&(this.maxScrollDepth=n,this.track("scroll_depth",{depth:this.maxScrollDepth}))}handleVisibilityChange(){document.hidden?this.track("page_hide",{activeTime:this.activeTime,totalTime:Date.now()-this.startTime}):this.track("page_show")}handleExit(){this.track("page_exit",{activeTime:this.activeTime,totalTime:Date.now()-this.startTime,maxScrollDepth:this.maxScrollDepth,interactions:this.interactions}),this.sendBatch(!0)}trackPerformance(){if(window.performance){const t=performance.timing,e=t.loadEventEnd-t.navigationStart,i=t.domContentLoadedEventEnd-t.navigationStart;this.track("performance",{loadTime:e,domLoadTime:i,firstPaint:performance.getEntriesByType("paint")[0]?.startTime}),this.measureConnectionSpeed()}}async measureConnectionSpeed(){try{const t=performance.now(),e=await fetch(`${this.config.endpoint}/beacon`,{cache:"no-cache"}),i=performance.now()-t,n=8*parseInt(e.headers.get("content-length")||0)/(i/1e3)/1e6;this.track("connection_speed",{speed:n})}catch(t){this.debug("Error measuring connection speed:",t)}}trackPageview(){this.track("pageview",{url:window.location.href,referrer:document.referrer,title:document.title,utmParams:this.getUtmParams()})}track(t,e={}){const i={eventType:t,timestamp:(new Date).toISOString(),visitorId:this.visitorId,sessionId:this.sessionId,domainId:this.config.domainId,url:window.location.href,userAgent:navigator.userAgent,...e};this.queue.push(i),this.debug(`Tracked ${t}:`,i),this.queue.length>=this.config.batchSize&&this.sendBatch()}startBatchProcessing(){setInterval((()=>{this.sendBatch()}),this.config.batchInterval)}async sendBatch(t=!1){if(0===this.queue.length)return;const e=this.queue.splice(0,this.config.batchSize);if(t&&navigator.sendBeacon)navigator.sendBeacon(`${this.config.endpoint}/collect`,JSON.stringify(e));else try{const t=await fetch(`${this.config.endpoint}/collect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`)}catch(t){this.debug("Error sending batch:",t),this.queue.unshift(...e)}}generateId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}getVisitorId(){let t=localStorage.getItem("_ia_vid");return t||(t=this.generateId(),localStorage.setItem("_ia_vid",t)),t}getUtmParams(){const t=new URLSearchParams(window.location.search);return{source:t.get("utm_source"),medium:t.get("utm_medium"),campaign:t.get("utm_campaign"),term:t.get("utm_term"),content:t.get("utm_content")}}debug(...t){this.config.debug&&console.log("[InsaneAnalytics]",...t)}}if("undefined"!=typeof window?window.InsaneAnalytics=e:t.exports=e,"undefined"!=typeof window&&window.ia&&window.ia.q){const t=window.ia.q;window.ia=function(){const i=new e;for(const e of t)"function"==typeof i[e[0]]&&i[e[0]].apply(i,e.slice(1));return i}}}},e={},function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}(877);var t,e}));